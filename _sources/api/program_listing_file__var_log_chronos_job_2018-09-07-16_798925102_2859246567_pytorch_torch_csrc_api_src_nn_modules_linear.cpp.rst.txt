:github_url: https://github.com/pytorch/pytorch


.. _program_listing_file__var_log_chronos_job_2018-09-07-16_798925102_2859246567_pytorch_torch_csrc_api_src_nn_modules_linear.cpp:

Program Listing for File linear.cpp
===================================

- Return to documentation for :ref:`file__var_log_chronos_job_2018-09-07-16_798925102_2859246567_pytorch_torch_csrc_api_src_nn_modules_linear.cpp`

.. code-block:: cpp

   #include <torch/nn/modules/linear.h>
   
   #include <torch/tensor.h>
   #include <torch/utils.h>
   
   #include <cmath>
   #include <cstdint>
   
   namespace torch {
   namespace nn {
   LinearOptions::LinearOptions(int64_t in, int64_t out) : in_(in), out_(out) {}
   
   LinearImpl::LinearImpl(LinearOptions options) : options(std::move(options)) {
     reset();
   }
   
   void LinearImpl::reset() {
     weight =
         register_parameter("weight", torch::empty({options.out_, options.in_}));
     if (options.with_bias_) {
       bias = register_parameter("bias", torch::empty(options.out_));
     }
   
     const auto stdv = 1.0 / std::sqrt(weight.size(1));
     NoGradGuard no_grad;
     for (auto& p : parameters()) {
       p->uniform_(-stdv, stdv);
     }
   }
   
   Tensor LinearImpl::forward(Tensor input) {
     AT_ASSERT(!options.with_bias_ || bias.defined());
     return torch::linear(input, weight, bias);
   }
   } // namespace nn
   } // namespace torch
